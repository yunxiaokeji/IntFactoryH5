@{
    ViewBag.Title = "订单详情";
}
@section css{
    <style type="text/css">
        .table-list {
            border: 1px solid #cad9ea;
            table-layout:fixed;
            color: #666;
        }

        .table-list th {
            background-repeat: repeat-x;
            height: 30px;
        }

        .table-list td,
        .table-list th {
            border: 1px solid #cad9ea;
            padding: 0 1em 0;
        }

        .table-list tr.alter {
            background-color: #f5fafe;
        }

        .task-ing {
            background: #45BF67;
        }

        .task-normal {
            background: #ccc;
        }

        .task-over {
            background: #3A7DE5;
        }

        .task-ing-col {
            color: #45BF67;
        }

        .task-normal-col {
            color: #ccc;
        }

        .task-over-col {
            color: #3A7DE5;
        }

        #progress .mui-navigate-right:after {
            color: #fff;
        }

        .mui-slider .mui-slider-group .mui-slider-item{
            max-height:400px;
        }
    </style>
}
<body>
    <div id="orderDetail">
        <header id="header" class="mui-bar mui-bar-nav">
            <h1 class="mui-title">款式: {{model.GoodsName?model.GoodsName:"未设置"}}</h1>
            @*<a class="mui-icon mui-icon-bars mui-pull-right"></a>*@
            <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
        </header>

        <div class="mui-content mBottom15">
            <div class="mui-slider">
                <div class="mui-slider-group" >
                    <div class="mui-slider-item" v-if="model.OrderImages==null || model.OrderImages==''"><a href="#"><img src="/modules/images/img-noimg.png" /></a></div>
                    <div class="mui-slider-item" v-for="img in model.OrderImages"><a href="#"><img v-bind:src="img" /></a></div>
                </div>
                <div class="mui-slider-indicator">
                    <div v-for=" (index,img)img in model.OrderImages" v-bind:class="index==0?'mui-indicator mui-active':'mui-indicator' "></div>
                </div>
            </div>

            <div class="mui-segmented-control mui-segmented-control-inverted mui-segmented-control-primary">
                <a class="mui-control-item mui-active" href="#detail">
                    详情
                </a>
                <a class="mui-control-item" href="#progress">
                    进度
                </a>
                <a class="mui-control-item" href="#quantity">
                    数量
                </a>
                <a class="mui-control-item" href="#materiel">
                    物料
                </a>
                <a class="mui-control-item" href="#remark">
                    备注
                </a>
            </div>

            <div id="detail" class="mui-control-content   mui-active">
                <ul class="mui-table-view mui-table-view-chevron">
                    <li class="mui-table-view-cell mui-collapse">
                        <a class="mui-navigate-right" href="#">客户信息</a>
                        <ul class="mui-table-view mui-table-view-chevron">
                            <li class="mui-table-view-cell bold">
                                <span>客户名称：</span><span>{{model.CustomerName}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>联系人：</span><span>{{model.PersonName}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>联系方式：</span><span>{{model.MobileTele}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>地址：</span><span>{{model.City?model.City.Description: ""}}{{model.Address}}</span>
                            </li>
                        </ul>
                    </li>
                    <li class="mui-table-view-cell mui-collapse">
                        <a class="mui-navigate-right" href="#">尺寸/工艺</a>
                        <ul class="mui-table-view mui-table-view-chevron">
                            <li class="mui-table-view-cell">
                                尺寸信息
                            </li>
                            <li class="mui-table-view-cell" id="platemaking" style="padding-right:5px;overflow-x:auto;" v-html=" model.Platemaking?decodeURI(model.Platemaking):'暂无制版信息' "></li>
                            <li class="mui-table-view-cell">
                                工艺说明
                            </li>
                            <li class="mui-table-view-cell" style="padding-right:5px;">
                                <table width="100%" class="table-list">
                                    <tr><th width="20%">类型</th><th width="30%">名称</th><th width="30%">描述</th><th width="20%">创建时间</th></tr>
                                    <tr v-for="item in plateMakings">
                                        <td>{{item.TypeName}}</td>
                                        <td>{{item.Title}}</td>
                                        <td style="word-break:break-all;">{{item.Remark}}</td>
                                        <td>{{item.CreateTime.toDate("yyyy-MM-dd")}}</td>
                                    </tr>
                                </table>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div id="progress" class="mui-control-content">
                <ul class="mui-table-view mui-table-view-chevron">
                    <li class="mui-table-view-cell center" style="padding:20px 0;">
                        <span>下单时间：</span><span>{{model.CreateTime?model.CreateTime.toDate("yyyy-MM-dd"):"未设置"}}</span>
                        <span class="mLeft10">交货时间：</span><span>{{ !model.PlanTime?"未设置":model.PlanTime.toDate("yyyy-MM-dd")<="1900-01-01"||model.PlanTime.toDate("yyyy-MM-dd")=="2040-01-01"?"未设置":model.PlanTime.toDate("yyyy-MM-dd")}}</span>
                    </li>
                    <li class="mui-table-view-cell mui-collapse" v-for="stage in model.Tasts">
                        <a href="#" v-bind:class=" (stage.FinishStatus==0?'task-normal ':stage.FinishStatus==1?'task-ing':'task-over' ) + ' mui-navigate-right' " style="color:#fff;margin-bottom:2px;">
                            <span class=" width150" style="display:inline-block">{{stage.Title}}</span>
                            <span class="mLeft30">{{stage.FinishStatus == 0 ? "未接受" : stage.FinishStatus == 1 ? "进行中" : "已完成"}}</span>
                        </a>
                        <ul class="mui-table-view mui-table-view-chevron">
                            <li v-bind:class=" (stage.FinishStatus==0?'task-normal-col ':stage.FinishStatus==1?'task-ing-col':'task-over-col' ) + ' mui-table-view-cell bold' ">
                                <span>任务状态：</span>
                                <span>{{stage.FinishStatus == 0 ? "未接受" : stage.FinishStatus == 1 ? "进行中" : "已完成"}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>任务编号： </span>
                                <span>{{stage.TaskCode}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>负责人： </span>
                                <span>{{stage.Owner.Name}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>到期时间： </span>
                                <span>{{stage.EndTime.toDate("yyyy-MM-dd") == "0001-01-01" ? "--" : stage.EndTime.toDate("yyyy-MM-dd")}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>接受时间： </span>
                                <span>{{stage.FinishStatus == 0 ? "--" : stage.AcceptTime.toDate("yyyy-MM-dd")}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>完成时间： </span>
                                <span>{{stage.FinishStatus == 0 ? "--" : stage.FinishStatus == 1 ? stage.EndTime.toDate("yyyy-MM-dd") : stage.CompleteTime.toDate("yyyy-MM-dd")}}</span>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div id="quantity" class="mui-control-content">
                <ul class="mui-table-view mui-table-view-chevron">
                    <li class="mui-table-view-cell mui-collapse" v-for="detail in model.OrderGoods">
                        <a class="mui-navigate-right" href="#"><span class="width200" style="display:inline-block;">{{detail.YRemark + detail.XRemark}}</span><span>数量 {{detail.Quantity}}</span></a>
                        <ul class="mui-table-view mui-table-view-chevron">
                            <li class="mui-table-view-cell">
                                <span>下单数量：</span>
                                <span>{{detail.Quantity}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>剪裁数量： </span>
                                <span>{{detail.CutQuantity}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>车缝数量： </span>
                                <span>{{detail.Complete}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>发货数量： </span>
                                <span>{{detail.SendQuantity}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>未发数量： </span>
                                <span>{{detail.Complete - detail.SendQuantity}}</span>
                            </li>
                        </ul>
                    </li>

                </ul>
            </div>

            <div id="materiel" class="mui-control-content ">
                <ul class="mui-table-view mui-table-view-chevron">
                    <li class="mui-table-view-cell mui-collapse" v-for="detail in model.Details">
                        <a class="mui-navigate-right" href="#"><span>{{detail.ProductName}}</span></a>
                        <ul class="mui-table-view mui-table-view-chevron">
                            <li class="mui-table-view-cell">
                                <span>编码：</span>
                                <span>{{detail.ProductCode? detail.ProductCode : detail.DetailsCode}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>规格： </span>
                                <span>客户名称</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>单位： </span>
                                <span>{{detail.UnitName}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>单价： </span>
                                <span>{{detail.Price}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>单件消耗： </span>
                                <span>{{detail.Quantity}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>采购数量： </span>
                                <span>{{detail.PlanQuantity}}</span>
                            </li>
                            <li class="mui-table-view-cell">
                                <span>小计： </span>
                                <span>{{detail.TotalMoney}}</span>
                            </li>
                        </ul>
                    </li>

                </ul>
            </div>

            <div id="remark" class="mui-control-content">
                <ul class="mui-table-view">
                    <li class="mui-table-view-cell">
                        {{model.Remark?model.Remark:""}}
                    </li>
                </ul>
            </div>
        </div>
    </div>
    @section scripts{
        <script src="/modules/scripts/orders/detail.js?v=1"></script>
    }
</body>
